{"openapi":"3.1.0","info":{"title":"Drowsiness Detection API","version":"0.1.0"},"paths":{"/users/register":{"post":{"tags":["users"],"summary":"Register","operationId":"register_users_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/token":{"post":{"tags":["users"],"summary":"Login For Access Token","operationId":"login_for_access_token_users_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_for_access_token_users_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/forgot-password":{"post":{"tags":["users"],"summary":"Forgot Password","description":"Sends a real password reset code via Email (SMTP).","operationId":"forgot_password_users_forgot_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/reset-password":{"post":{"tags":["users"],"summary":"Reset Password","description":"Resets user password using the code.","operationId":"reset_password_users_reset_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/me":{"get":{"tags":["users"],"summary":"Read Users Me","operationId":"read_users_me_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"put":{"tags":["users"],"summary":"Update Users Me","operationId":"update_users_me_users_me_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/contacts/":{"get":{"tags":["contacts"],"summary":"Read Contacts","operationId":"read_contacts_contacts__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ContactResponse"},"type":"array","title":"Response Read Contacts Contacts  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["contacts"],"summary":"Create Contact","operationId":"create_contact_contacts__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/contacts/{contact_id}":{"delete":{"tags":["contacts"],"summary":"Delete Contact","operationId":"delete_contact_contacts__contact_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"contact_id","in":"path","required":true,"schema":{"type":"integer","title":"Contact Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["contacts"],"summary":"Update Contact","operationId":"update_contact_contacts__contact_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"contact_id","in":"path","required":true,"schema":{"type":"integer","title":"Contact Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/trips/start":{"post":{"tags":["trips"],"summary":"Start Trip","operationId":"start_trip_trips_start_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TripResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/trips/end":{"post":{"tags":["trips"],"summary":"End Trip","operationId":"end_trip_trips_end_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TripResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/trips/{trip_id}/logs":{"post":{"tags":["trips"],"summary":"Create Log","operationId":"create_log_trips__trip_id__logs_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"trip_id","in":"path","required":true,"schema":{"type":"integer","title":"Trip Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectionLogCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectionLogResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/trips/detections":{"post":{"tags":["trips"],"summary":"Create Detection Auto Trip","description":"Auto-resolve active trip and log detection. \nUseful if client doesn't have trip_id handy.","operationId":"create_detection_auto_trip_trips_detections_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectionLogCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectionLogResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/statistics/trips":{"get":{"tags":["statistics"],"summary":"Get My Trips","description":"Get user's trip history (summary only, no logs) with optional period filter","operationId":"get_my_trips_statistics_trips_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Limit"}},{"name":"period","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/StatsPeriod"},{"type":"null"}],"title":"Period"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TripSummary"},"title":"Response Get My Trips Statistics Trips Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/statistics/trips/{trip_id}":{"get":{"tags":["statistics"],"summary":"Get Trip Details","description":"Get details of a specific trip including all detection logs","operationId":"get_trip_details_statistics_trips__trip_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"trip_id","in":"path","required":true,"schema":{"type":"integer","title":"Trip Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TripWithLogs"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/statistics/summary":{"get":{"tags":["statistics"],"summary":"Get Statistics Summary","description":"Get overall statistics for the user with optimized response","operationId":"get_statistics_summary_statistics_summary_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/StatsPeriod"},{"type":"null"}],"title":"Period"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserStatistics"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/statistics/durations":{"get":{"tags":["statistics"],"summary":"Get Driving Stats","description":"Get driving duration statistics for Today, Week, Month, Year","operationId":"get_driving_stats_statistics_durations_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DrivingStatsResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/statistics/calendar":{"get":{"tags":["statistics"],"summary":"Get Checkin Calendar","description":"Get list of days (dates) where user had driving activity in a specific month","operationId":"get_checkin_calendar_statistics_calendar_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"month","in":"query","required":true,"schema":{"type":"integer","maximum":12,"minimum":1,"title":"Month"}},{"name":"year","in":"query","required":true,"schema":{"type":"integer","maximum":2100,"minimum":2000,"title":"Year"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CalendarCheckinResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_login_for_access_token_users_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_for_access_token_users_token_post"},"CalendarCheckinResponse":{"properties":{"active_days":{"items":{"type":"string","format":"date-time"},"type":"array","title":"Active Days"}},"type":"object","required":["active_days"],"title":"CalendarCheckinResponse"},"ContactCreate":{"properties":{"name":{"type":"string","title":"Name"},"phone_number":{"type":"string","title":"Phone Number"},"is_active":{"type":"boolean","title":"Is Active","default":true}},"type":"object","required":["name","phone_number"],"title":"ContactCreate"},"ContactResponse":{"properties":{"name":{"type":"string","title":"Name"},"phone_number":{"type":"string","title":"Phone Number"},"is_active":{"type":"boolean","title":"Is Active","default":true},"contact_id":{"type":"integer","title":"Contact Id"},"user_id":{"type":"integer","title":"User Id"}},"type":"object","required":["name","phone_number","contact_id","user_id"],"title":"ContactResponse"},"ContactUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"phone_number":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Phone Number"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"ContactUpdate"},"DetectionLogCreate":{"properties":{"event_type":{"type":"string","title":"Event Type"},"confidence":{"type":"number","title":"Confidence"},"gps_location":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Gps Location"},"timestamp":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Timestamp"}},"type":"object","required":["event_type","confidence"],"title":"DetectionLogCreate"},"DetectionLogResponse":{"properties":{"event_type":{"type":"string","title":"Event Type"},"confidence":{"type":"number","title":"Confidence"},"gps_location":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Gps Location"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"},"log_id":{"type":"integer","title":"Log Id"},"trip_id":{"type":"integer","title":"Trip Id"}},"type":"object","required":["event_type","confidence","timestamp","log_id","trip_id"],"title":"DetectionLogResponse"},"DrivingStatsResponse":{"properties":{"today_hours":{"type":"number","title":"Today Hours"},"week_hours":{"type":"number","title":"Week Hours"},"month_hours":{"type":"number","title":"Month Hours"},"year_hours":{"type":"number","title":"Year Hours"}},"type":"object","required":["today_hours","week_hours","month_hours","year_hours"],"title":"DrivingStatsResponse"},"ForgotPasswordRequest":{"properties":{"email":{"type":"string","title":"Email"}},"type":"object","required":["email"],"title":"ForgotPasswordRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ResetPasswordRequest":{"properties":{"email":{"type":"string","title":"Email"},"new_password":{"type":"string","title":"New Password"},"code":{"type":"string","title":"Code"}},"type":"object","required":["email","new_password","code"],"title":"ResetPasswordRequest"},"StatsPeriod":{"type":"string","enum":["TODAY","THIS_WEEK","THIS_MONTH","THIS_YEAR"],"title":"StatsPeriod"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type"}},"type":"object","required":["access_token","token_type"],"title":"Token"},"TripResponse":{"properties":{"trip_id":{"type":"integer","title":"Trip Id"},"user_id":{"type":"integer","title":"User Id"},"start_time":{"type":"string","format":"date-time","title":"Start Time"},"end_time":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"End Time"},"status":{"$ref":"#/components/schemas/TripStatus"}},"type":"object","required":["trip_id","user_id","start_time","status"],"title":"TripResponse"},"TripStatus":{"type":"string","enum":["ONGOING","FINISHED"],"title":"TripStatus"},"TripSummary":{"properties":{"trip_id":{"type":"integer","title":"Trip Id"},"user_id":{"type":"integer","title":"User Id"},"start_time":{"type":"string","format":"date-time","title":"Start Time"},"end_time":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"End Time"},"status":{"$ref":"#/components/schemas/TripStatus"},"total_detections":{"type":"integer","title":"Total Detections","default":0},"duration_minutes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Duration Minutes"}},"type":"object","required":["trip_id","user_id","start_time","status"],"title":"TripSummary"},"TripWithLogs":{"properties":{"trip_id":{"type":"integer","title":"Trip Id"},"user_id":{"type":"integer","title":"User Id"},"start_time":{"type":"string","format":"date-time","title":"Start Time"},"end_time":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"End Time"},"status":{"$ref":"#/components/schemas/TripStatus"},"logs":{"items":{"$ref":"#/components/schemas/DetectionLogResponse"},"type":"array","title":"Logs","default":[]},"total_detections":{"type":"integer","title":"Total Detections","default":0},"duration_minutes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Duration Minutes"}},"type":"object","required":["trip_id","user_id","start_time","status"],"title":"TripWithLogs"},"UserCreate":{"properties":{"email":{"type":"string","title":"Email"},"full_name":{"type":"string","title":"Full Name"},"phone_number":{"type":"string","title":"Phone Number"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","full_name","phone_number","password"],"title":"UserCreate"},"UserResponse":{"properties":{"email":{"type":"string","title":"Email"},"full_name":{"type":"string","title":"Full Name"},"phone_number":{"type":"string","title":"Phone Number"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"},"user_id":{"type":"integer","title":"User Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["email","full_name","phone_number","user_id","created_at"],"title":"UserResponse"},"UserStatistics":{"properties":{"total_trips":{"type":"integer","title":"Total Trips"},"total_detections":{"type":"integer","title":"Total Detections"},"total_duration_minutes":{"type":"integer","title":"Total Duration Minutes"},"detection_breakdown":{"additionalProperties":true,"type":"object","title":"Detection Breakdown"},"recent_trips":{"items":{"$ref":"#/components/schemas/TripSummary"},"type":"array","title":"Recent Trips"}},"type":"object","required":["total_trips","total_detections","total_duration_minutes","detection_breakdown","recent_trips"],"title":"UserStatistics"},"UserUpdate":{"properties":{"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"phone_number":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Phone Number"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"}},"type":"object","title":"UserUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/users/token"}}}}}}